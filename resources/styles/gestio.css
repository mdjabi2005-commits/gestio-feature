/* =============================================================
   Gestio — Feuille de styles principale
   Chargée via load_all_styles() → styles.py
   ============================================================= */

/* ── 0. POLICE ─────────────────────────────────────────────── */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

/* ── 1. VARIABLES (palette officielle Gestio) ───────────────── */
:root {
    --primary: hsl(160, 84%, 39%);
    /* Vert émeraude  #10B981 */
    --primary-fg: hsl(0, 0%, 100%);
    /* Blanc          #FFFFFF */
    --secondary: hsl(160, 64%, 28%);
    /* Vert forêt     #059669 */
    --accent: hsl(38, 92%, 50%);
    /* Ambre          #F59E0B */
    --destructive: hsl(0, 84%, 60%);
    /* Rouge          #EF4444 */
    --background: hsl(222, 47%, 11%);
    /* Fond sombre    #111827 */
    --card: hsl(217, 33%, 17%);
    /* Carte          #1E293B */
    --foreground: hsl(210, 40%, 98%);
    /* Texte          #F8FAFC */
    --muted: hsl(217, 19%, 27%);
    /* Gris moyen     #334155 */
    --muted-foreground: hsl(215, 16%, 57%);
    /* Gris clair     #94A3B8 */
    --border: hsl(217, 19%, 27%);
    /* Bordure        #334155 */
    --ring: hsl(160, 84%, 39%);
    /* Focus ring     #10B981 */

    --radius: 0.75rem;
    --shadow: 0 4px 6px rgba(0, 0, 0, 0.35);
    --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.45);
}

/* ── 2. TOOLBAR STREAMLIT ───────────────────────────────────────
   On réduit le header à 0 pour économiser de l'espace vertical,
   mais on garde overflow:visible pour que les boutons flottants
   restent cliquables.
   ─────────────────────────────────────────────────────────────── */
[data-testid="stHeader"],
[data-testid="stToolbar"] {
    height: 0 !important;
    min-height: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
    background: transparent !important;
    border: 0 !important;
    overflow: visible !important;
    /* indispensable : les boutons sont des enfants */
}

/* Masquer les actions inutiles de la toolbar (Deploy, ⋮, barre déco) */
[data-testid="stToolbarActions"],
[data-testid="stStatusWidget"],
[data-testid="stDecoration"],
[data-testid="stAppDeployButton"],
/* bouton Deploy (haut droite) */
[data-testid="stMainMenu"] {
    /* menu ⋮ (trois points, haut droite) */
    display: none !important;
}

/* Barre bleue Streamlit en haut de page — la rendre invisible */
[data-testid="stHeader"]::before,
[data-testid="stHeader"]::after {
    display: none !important;
    background: transparent !important;
}


/* ── 3. BOUTONS SIDEBAR ─────────────────────────────────────────
   Deux boutons distincts dans Streamlit (confirmés par inspection DOM) :
     • stSidebarCollapseButton → bouton << (sidebar OUVERTE)
     • stExpandSidebarButton   → bouton >  (sidebar REPLIÉE, flottant)
   ─────────────────────────────────────────────────────────────── */

/* Bouton << — visible à l'intérieur de la sidebar ouverte */
[data-testid="stSidebarCollapseButton"] {
    visibility: visible !important;
    pointer-events: auto !important;
    position: fixed !important;
    top: 1rem !important;
    /* ← ajuster si besoin */
    left: 0.5rem !important;
    z-index: 10001 !important;
    opacity: 1 !important;
    color: var(--foreground) !important;
    background: var(--card) !important;
    border: 1px solid var(--border) !important;
    border-radius: 999px !important;
    box-shadow: var(--shadow) !important;
}

/* Bouton > — flottant quand la sidebar est repliée.
   Doit être sous la barre du navigateur (adresse + favoris ≈ 110px = 6.5rem). */
[data-testid="stExpandSidebarButton"] {
    visibility: visible !important;
    pointer-events: auto !important;
    position: fixed !important;
    top: 1rem !important;
    /* ← ajuster si besoin (augmenter = descendre) */
    left: 0.5rem !important;
    z-index: 10001 !important;
    opacity: 1 !important;
    color: var(--foreground) !important;
    background: var(--card) !important;
    border: 1px solid var(--border) !important;
    border-radius: 999px !important;
    box-shadow: var(--shadow) !important;
}

/* ── 4. FOND & TEXTE GLOBAL ─────────────────────────────────── */
/* !important nécessaire : Streamlit écrase .stApp */
.stApp {
    background: linear-gradient(160deg,
            hsl(222, 47%, 10%) 0%,
            hsl(215, 45%, 12%) 40%,
            hsl(200, 40%, 11%) 100%) !important;
    color: var(--foreground) !important;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif !important;
}

/* Conserver la police Material Icons (ne pas l'écraser avec Inter) */
.material-icons,
.material-symbols-rounded,
.material-symbols-outlined,
[class*="material-symbols"] {
    font-family: 'Material Icons' !important;
}

input,
textarea,
select {
    font-family: 'Inter', sans-serif !important;
}

/* ── 5. LAYOUT ──────────────────────────────────────────────── */
.main .block-container,
.block-container {
    padding: 1rem 2rem !important;
    max-width: 1400px !important;
    margin: 0 auto;
}

section[data-testid="stSidebar"] {
    background: linear-gradient(180deg,
            hsl(217, 33%, 15%) 0%,
            hsl(222, 47%, 11%) 100%) !important;
    border-right: 1px solid var(--border) !important;
}

section[data-testid="stSidebar"] * {
    color: var(--foreground) !important;
}

div[data-testid="stVerticalBlock"] {
    gap: 0.5rem;
}

/* ── 6. BOUTONS STREAMLIT ───────────────────────────────────── */
/* !important requis sur background et border */
.stButton>button {
    border-radius: var(--radius) !important;
    font-weight: 600 !important;
    font-family: 'Inter', sans-serif !important;
    padding: 0.5rem 1.25rem !important;
    border: 1px solid var(--border) !important;
    background: var(--card) !important;
    color: var(--foreground) !important;
    box-shadow: var(--shadow);
    transition: all 0.2s ease;
}

.stButton>button:hover {
    background: var(--muted) !important;
    border-color: var(--primary) !important;
    transform: translateY(-1px);
    box-shadow: var(--shadow-lg) !important;
}

.stButton>button:focus {
    box-shadow: 0 0 0 2px var(--ring) !important;
    outline: none !important;
}

/* Variante primaire (kind="primary") */
.stButton>button[kind="primary"] {
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%) !important;
    color: var(--primary-fg) !important;
    border: none !important;
}

.stButton>button[kind="primary"]:hover {
    background: linear-gradient(135deg,
            hsl(160, 84%, 45%) 0%,
            hsl(160, 64%, 34%) 100%) !important;
    box-shadow: 0 4px 16px rgba(16, 185, 129, 0.4) !important;
}

/* Variante secondaire (kind="secondary") */
.stButton>button[kind="secondary"] {
    background: transparent !important;
    border: 1px solid var(--border) !important;
    color: var(--foreground) !important;
}

.stButton>button[kind="secondary"]:hover {
    border-color: var(--primary) !important;
    color: var(--primary) !important;
}

/* 8. CALENDRIER (popup date picker) ──────────────────────────
   Le popup BaseWeb n'a pas de fond par défaut → les jours
   flottent sur le contenu en dessous. On l'encapsule en card.
   Sélecteurs confirmés par inspection DOM.
   ─────────────────────────────────────────────────────────────── */

/* Popover = couche flottante qui contient le calendrier */
[data-baseweb="popover"] {
    background: var(--card) !important;
    border: 1px solid var(--border) !important;
    border-radius: var(--radius) !important;
    box-shadow: var(--shadow-lg) !important;
}

/* Calendrier interne */
[data-baseweb="calendar"] {
    background: var(--card) !important;
    color: var(--foreground) !important;
    border-radius: var(--radius) !important;
}

/* Cellules de jours */
[data-baseweb="calendar"] [role="gridcell"] button {
    color: var(--foreground) !important;
    border-radius: 50% !important;
    background: transparent !important;
}

/* Jour sélectionné / aujourd'hui */
[data-baseweb="calendar"] [aria-selected="true"] button {
    background: var(--primary) !important;
    color: var(--primary-fg) !important;
}

/* En-têtes des colonnes (Mo, Tu…) */
[data-baseweb="calendar"] [role="columnheader"] {
    color: var(--muted-foreground) !important;
    font-weight: 600 !important;
    font-size: 0.75rem !important;
}

/* 7. CHAMPS DE SAISIE ────────────────────────────────────── */
.stTextInput>div>div>input,
.stNumberInput>div>div>input,
.stTextArea>div>div>textarea {
    background: var(--card) !important;
    color: var(--foreground) !important;
    border: 1px solid var(--border) !important;
    border-radius: var(--radius) !important;
    padding: 0.5rem 1rem !important;
    font-size: 0.9375rem !important;
    transition: border-color 0.2s ease;
}

.stTextInput>div>div>input:focus,
.stNumberInput>div>div>input:focus,
.stTextArea>div>div>textarea:focus {
    border-color: var(--primary) !important;
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.15) !important;
}

.stSelectbox>div>div,
.stMultiSelect>div>div {
    background: var(--card) !important;
    color: var(--foreground) !important;
    border: 1px solid var(--border) !important;
    border-radius: var(--radius) !important;
}

.stDateInput>div>div>input {
    background: var(--card) !important;
    color: var(--foreground) !important;
    border: 1px solid var(--border) !important;
    border-radius: var(--radius) !important;
}

/* ── 8. MÉTRIQUES ───────────────────────────────────────────── */
[data-testid="stMetricValue"] {
    font-size: 2rem !important;
    font-weight: 700 !important;
    color: var(--primary) !important;
}

[data-testid="stMetricLabel"] {
    font-size: 0.75rem !important;
    font-weight: 600 !important;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--muted-foreground) !important;
}

[data-testid="stMetricDelta"] {
    font-size: 1rem !important;
    font-weight: 600 !important;
}

/* ── 9. TABLEAUX / DATAFRAMES ───────────────────────────────── */
div[data-testid="stDataFrame"] {
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    border: 1px solid var(--border);
}

div[data-testid="stDataFrame"] div[role="gridcell"] {
    font-size: 0.9375rem !important;
    padding: 10px !important;
    border-bottom: 1px solid var(--border);
    color: var(--foreground) !important;
}

div[data-testid="stDataFrame"] div[role="columnheader"] {
    background: var(--card) !important;
    color: var(--muted-foreground) !important;
    font-weight: 600 !important;
    font-size: 0.75rem !important;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* ── 10. EXPANDERS ──────────────────────────────────────────── */
[data-testid="stExpander"]>div:first-child {
    background: var(--card) !important;
    color: var(--foreground) !important;
    border: 1px solid var(--border) !important;
    border-radius: var(--radius) !important;
    font-weight: 600;
    padding: 0.75rem 1rem !important;
}

[data-testid="stExpander"] {
    border: 1px solid var(--border) !important;
    border-radius: var(--radius) !important;
    background: var(--card) !important;
}

/* ── 11. GRAPHIQUES ─────────────────────────────────────────── */
.stPlotlyChart,
.stPyplot {
    background: var(--card) !important;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: 1rem;
    border: 1px solid var(--border);
}

/* ── 12. ALERTES (success / error / warning / info) ─────────── */
[data-testid="stAlert"] {
    border-radius: var(--radius) !important;
    padding: 1rem !important;
    margin: 0.5rem 0 !important;
    border-left: 4px solid !important;
}

div[data-testid="stAlert"]:has(svg[data-testid="stAlertDynamicIcon-info"]),
div[data-testid="stAlert"]:has(svg[data-testid="stAlertDynamicIcon-success"]) {
    border-left-color: var(--primary) !important;
    background: rgba(16, 185, 129, 0.10) !important;
    color: var(--foreground) !important;
}

div[data-testid="stAlert"]:has(svg[data-testid="stAlertDynamicIcon-error"]) {
    border-left-color: var(--destructive) !important;
    background: rgba(239, 68, 68, 0.10) !important;
    color: var(--foreground) !important;
}

div[data-testid="stAlert"]:has(svg[data-testid="stAlertDynamicIcon-warning"]) {
    border-left-color: var(--accent) !important;
    background: rgba(245, 158, 11, 0.10) !important;
    color: var(--foreground) !important;
}

/* ── 13. BARRE DE PROGRESSION ───────────────────────────────── */
.stProgress>div>div>div>div {
    background: linear-gradient(90deg, var(--primary), var(--accent)) !important;
    border-radius: 999px !important;
}

/* ── 14. TITRES ─────────────────────────────────────────────── */
h1,
h2,
h3,
h4,
h5,
h6 {
    color: var(--foreground) !important;
    font-family: 'Inter', sans-serif !important;
    font-weight: 700;
    letter-spacing: -0.025em;
}

/* ── 15. SÉPARATEURS & SCROLLBAR ────────────────────────────── */
hr {
    border-color: var(--border) !important;
    margin: 1.5rem 0;
}

::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--background);
    border-radius: 999px;
}

::-webkit-scrollbar-thumb {
    background: var(--muted);
    border-radius: 999px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--primary);
}

/* ── 16. ANIMATION D'ENTRÉE ─────────────────────────────────── */
@keyframes gestioFadeIn {
    from {
        opacity: 0;
        transform: translateY(12px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.stButton,
[data-testid="stMetricValue"],
div[data-testid="stDataFrame"] {
    animation: gestioFadeIn 0.3s ease-out;
}

/* ── 17. RESPONSIVE MOBILE ──────────────────────────────────── */
@media (max-width: 768px) {
    [data-testid="stMetricValue"] {
        font-size: 1.5rem !important;
    }

    .stButton>button {
        width: 100% !important;
        margin: 0.4rem 0 !important;
    }

    div[data-testid="stDataFrame"] div[role="gridcell"] {
        font-size: 13px !important;
        padding: 6px !important;
    }

    .main .block-container,
    .block-container {
        padding: 0.5rem 0.75rem !important;
    }
}

/* ── 18. CLASSES UTILITAIRES GESTIO ─────────────────────────── */
.gestio-banner {
    font-weight: 700;
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.03em;
}